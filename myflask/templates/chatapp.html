{% extends 'layout.html' %}

{% block content %}

<div class="container-fluid">
    <div class="well text-center">
        <h4>My Chat App</h4>
    </div>

    <style>
        div.msgbbl{
            background-color: #ddd;
            padding: 5px 10px;
            border-radius : 10px;
            color : $#555;
            margin-bottom : 5px;
        }
    </style>

    <div class="col-sm-8">
        <div id="nomsg">
            <h1 style="color: #ccc"> No Messages Yet! </h1>
            <div class="msg-wrapper"></div>
        </div>
    </div>
    <br>
    <div class="col-sm-4">
        <form action="#" method="POST">
            <b style="color:white">Type your message Below <span class="fas fa-chevron-down"</span></b>
            <hr>
            <div class="form-group">
                <label for="exampleInputEmail1">Email address</label>
                <input type="email" class="username form-control" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="Enter email">
                <small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone else.</small>
            </div>
            <div class="form-group">
                <label for="exampleInputPassword1">Message</label>
                <input type="text" class="message form-control" id="exampleInputPassword1" placeholder="Message to be sent">
            </div><hr>
            <button type="submit" class="btn btn-success">Send Message <span class="fas fa-comment"></span></button>
        </form>
    </div>
</div>

<script>
    var socket = io.connect('http://localhost:5000/')
    socket.on('connect',function()
    {
        socket.emit('event',{
            data:'User Connected'
        })
    })
    var form = $('form').on('submit',function(e)
{
    e.preventDefault()
    var user = $('input.username').val()
    var message = $('input.message').val()
    socket.emit('event',{
        user:user,
        msg:message
    })
    $('input.message').val('').focus()
})

socket.on('my response',function(msg)
{
    if (typeof msg.user !== 'undefined')
    {
        $('h1').remove()
        $('div.msg-wrapper').append('<div class="msgbbl"><b>'+msg.user+'</b> : '+msg.msg+'</div')
    }
})
</script>
{% endblock %}
